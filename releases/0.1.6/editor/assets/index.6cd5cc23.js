import"./modulepreload-polyfill.b7f2da20.js";import{W as U,l as h,e as f}from"./vendor.088df017.js";import*as F from"../../wasm-interpreter/sixtyfps_wasm_interpreter.js";import R from"../../wasm-interpreter/sixtyfps_wasm_interpreter.js";const V={defaultToken:"invalid",root_keywords:["import","from","export"],inner_keywords:["property","callback","animate","states","transitions","if","for"],lang_keywords:["root","parent","this","if"],type_keywords:["int","string","float","length","physical_length","duration"],escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,symbols:/[\#\!\%\&\*\+\-\.\/\:\;\<\=\>\@\^\|_\?,()]+/,tokenizer:{root:[[/[a-zA-Z_][a-zA-Z0-9_]*/,{cases:{"@root_keywords":{token:"keyword"},"@default":"identifier"}}],{include:"@whitespace"},{include:"@numbers"},[/"/,"string","@string"],[/\{/,"","@inner"],[/@symbols/,""]],inner:[[/[a-zA-Z_][a-zA-Z0-9_\-]*\s*:=/,"variable.parameter"],[/[a-zA-Z_][a-zA-Z0-9_\-]*\s*:\s*\{/,"variable.parameter","@binding_1"],[/[a-zA-Z_][a-zA-Z0-9_\-]*\s*:/,"variable.parameter","@binding_0"],[/[a-zA-Z_][a-zA-Z0-9_\-]*/,{cases:{"@inner_keywords":{token:"keyword"},"@default":"identifier"}}],{include:"@whitespace"},{include:"@numbers"},[/"/,"string","@string"],[/\{/,"","@push"],[/\}/,"","@pop"],[/:=/,""],[/<=>/,"","@binding_0"],[/=>\s*{/,"","@binding_1"],[/\</,"","@type"],[/\[/,"","binding_1"],[/@symbols/,""]],type:[[/[a-zA-Z_][a-zA-Z0-9_]*/,{cases:{"@type_keywords":{token:"keyword.type"},"@default":"identifier"}}],{include:"@whitespace"},{include:"@numbers"},[/"/,"string","@string"],[/\</,"","@push"],[/\>/,"","@pop"],[/@symbols/,""]],binding_0:[{include:"@whitespace"},[/\{/,"","@binding_1"],[/;/,"","@pop"],[/\}/,"","@pop"],[/[a-zA-Z_][a-zA-Z0-9_]*/,{cases:{"@lang_keywords":{token:"keyword.type"},"@default":"identifier"}}],{include:"@numbers"},[/"/,"string","@string"],[/@symbols/,""]],binding_1:[[/[a-zA-Z_][a-zA-Z0-9_]*/,{cases:{"@lang_keywords":{token:"keyword.type"},"@default":"identifier"}}],{include:"@whitespace"},{include:"@numbers"},[/"/,"string","@string"],[/\{/,"","@push"],[/\}/,"","@pop"],[/\[/,"","@push"],[/\]/,"","@pop"],[/@symbols/,""]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],comment:[[/[^\/*]+/,"comment"],[/\/\*/,"comment","@push"],["\\*/","comment","@pop"],[/[\/*]/,"comment"]],numbers:[[/\d+(\.\d+)?\w*/,{token:"number"}],[/#[0-9a-fA-F]+/,{token:"number"}]]}};self.MonacoEnvironment={getWorker(l,c){return new U}};(async function(){await R(),h.register({id:"sixtyfps"}),h.onLanguage("sixtyfps",()=>{h.setMonarchTokensProvider("sixtyfps",V)});var l=f.create(document.getElementById("editor"),{language:"sixtyfps"}),c="",r=new Map;let v=`
import { SpinBox, Button, CheckBox, Slider, GroupBox } from "sixtyfps_widgets.60";
export Demo := Window {
    width:  300px;   // Width in logical pixels. All 'px' units are automatically scaled with screen resolution.
    height: 300px;
    t:= Text {
        text: "Hello World";
        font-size: 24px;
    }
    Image {
        y: 50px;
        source: @image-url("https://sixtyfps.io/resources/logo_scaled.png");
    }
}
`;function k(e){_(),fetch(e).then(t=>t.text().then(n=>{c=e;let a=p(n,e);d(a,e)}))}let g=document.getElementById("select_combo");function C(){if(g.value){let t="master";var e;(e=window.location.pathname.match(/releases\/([^\/]*)\/editor/))&&(t="v"+e[1]),k(`https://raw.githubusercontent.com/sixtyfpsui/sixtyfps/${t}/${g.value}`)}else _(),c="",p(v,""),d()}g.onchange=C;let I=document.getElementById("style_combo");I.onchange=m;let S=document.getElementById("compile_button");S.onclick=function(){m()};let y=document.getElementById("auto_compile");y.onchange=function(){y.checked&&m()};function N(e){if(e==="")return"unnamed.60";try{let n=new URL(e).pathname;return n.substring(n.lastIndexOf("/")+1)}catch{return e}}function x(){y.checked&&(b&&clearTimeout(b),b=setTimeout(m,500))}function p(e,t){let n=f.createModel(e,"sixtyfps");return n.onDidChangeContent(function(){let a=document.getElementById("permalink"),s=new URLSearchParams;s.set("snippet",l.getModel().getValue());let o=new URL(window.location.toString());o.search=s.toString(),a.href=o.toString(),x()}),r.set(t,{model:n,view_state:null}),m(),n}function _(){let e=document.getElementById("tabs");e.innerHTML="",r.clear()}function d(e,t=""){let n=document.getElementById("tabs"),a=document.createElement("li");a.setAttribute("class","nav-item"),a.dataset.url=t,a.innerHTML=`<span class="nav-link">${N(t)}</span>`,n.appendChild(a),$(a).on("click",s=>{s.preventDefault(),A(t)}),n.childElementCount==1&&A(t)}function A(e){let t=document.querySelector('#tabs li[class~="nav-item"] span[class~="nav-link"][class~="active"]');if(t!=null){t.className="nav-link";let s=t.parentElement.dataset.url;if(s!=null){let o=r.get(s);o.view_state=l.saveViewState(),r.set(s,o)}}let n=document.querySelector(`#tabs li[class~="nav-item"][data-url="${e}"] span[class~="nav-link"]`);n!=null&&(n.className="nav-link active");let a=r.get(e);a!=null&&(l.setModel(a.model),a.view_state!=null&&l.restoreViewState(a.view_state),l.focus())}function m(){let e=r.get(c);if(e===void 0)return;let t=e.model.getValue(),n=document.getElementById("preview");setTimeout(function(){W(t,c,n)},1)}async function W(e,t,n){let a=document.getElementById("style_combo"),s="canvas_"+Math.random().toString(36).substr(2,9),o=document.createElement("canvas");o.width=800,o.height=600,o.id=s,n.innerHTML="",n.appendChild(o);var T=[];let{component:Z,diagnostics:H,error_string:B}=await F.compile_from_string_with_style(e,t,a.value,async i=>{let u=r.get(i);if(u===void 0){let L=await(await fetch(i)).text(),w=f.createModel(L,"sixtyfps");return w.onDidChangeContent(function(){x()}),r.set(i,{model:w,view_state:null}),d(w,i),L}return u.model.getValue()});if(B!=""){let i=document.createTextNode(B),u=document.createElement("pre");u.appendChild(i),n.innerHTML="<pre style='color: red; background-color:#fee; margin:0'>"+u.innerHTML+"</pre>"}T=H.map(function(i){return{severity:3-i.level,message:i.message,source:i.fileName,startLineNumber:i.lineNumber,startColumn:i.columnNumber,endLineNumber:i.lineNumber,endColumn:-1}}),f.setModelMarkers(l.getModel(),"sixtyfps",T),Z!==void 0&&Z.run(s)}let b;const z=new URLSearchParams(window.location.search),M=z.get("snippet"),E=z.get("load_url");M?(_(),p(M,""),d()):E?k(E):(_(),c="",p(v,""),d())})();
