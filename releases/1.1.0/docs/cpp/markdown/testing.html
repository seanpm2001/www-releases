<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.09.29"/>
        <title>Slint tests - Slint C++ API documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_tweak.css" />
    <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Slint C++ API  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="https://slint.dev/logo/slint-logo-small-light.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Slint C++ API  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cmake.html">Installing Or Building With CMake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">First Steps</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++ / .slint Integration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../types.html">Type Mapping to C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generated_code.html">Example Generated Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/library_root.html">C++ API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/namespace_slint.html">Namespace slint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/namespace_slint__interpreter.html">Namespace slint::interpreter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1Image.html">Struct Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1interpreter_1_1Diagnostic.html">Struct Diagnostic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1interpreter_1_1PropertyDescriptor.html">Struct PropertyDescriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1interpreter_1_1Struct.html">Struct Struct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1interpreter_1_1Struct_1_1iterator.html">Struct Struct::iterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1LogicalPosition.html">Struct LogicalPosition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1LogicalSize.html">Struct LogicalSize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1PhysicalPosition.html">Struct PhysicalPosition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1PhysicalSize.html">Struct PhysicalSize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1Point.html">Template Struct Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1Rgb8Pixel.html">Struct Rgb8Pixel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1Rgba8Pixel.html">Struct Rgba8Pixel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1RgbaColor.html">Template Struct RgbaColor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1SharedPixelBuffer.html">Template Struct SharedPixelBuffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1SharedString.html">Struct SharedString</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1SharedVector.html">Template Struct SharedVector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1Size.html">Template Struct Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1StandardListViewItem.html">Struct StandardListViewItem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/structslint_1_1Timer.html">Struct Timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1Brush.html">Class Brush</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1Color.html">Class Color</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1ComponentHandle.html">Template Class ComponentHandle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1ComponentWeakHandle.html">Template Class ComponentWeakHandle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1FilterModel.html">Template Class FilterModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1interpreter_1_1ComponentCompiler.html">Class ComponentCompiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1interpreter_1_1ComponentDefinition.html">Class ComponentDefinition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1interpreter_1_1ComponentInstance.html">Class ComponentInstance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1interpreter_1_1Value.html">Class Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1MapModel.html">Template Class MapModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1Model.html">Template Class Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1SortModel.html">Template Class SortModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1VectorModel.html">Template Class VectorModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classslint_1_1Window.html">Class Window</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum_namespaceslint_1a9b8672f3333a9d534f3c1ecd8497b833.html">Enum CloseRequestResponse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum_namespaceslint_1a363af807a22999b1816ca4f57a40abf1.html">Enum GraphicsAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum_namespaceslint_1_1interpreter_1a024a0b8492190ef68961f9888a25b4b6.html">Enum DiagnosticLevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum_namespaceslint_1_1interpreter_1a6221319f778c7369e1b76672690926e0.html">Enum ValueType</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum_namespaceslint_1acf929c06c4c92899f6534ad9bc92e20a.html">Enum RenderingState</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum_namespaceslint_1ad4eb7e86e076aa0f5133a132c364c233.html">Enum SetRenderingNotifierError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum_namespaceslint_1a90456661c07d02d73ab90733c8755282.html">Enum TimerMode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/function_namespaceslint_1a9ade5df8e39fbec7d2af3c0dd3bd4d9c.html">Template Function slint::blocking_invoke_from_event_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/function_namespaceslint_1a4067c90b05ef4cb20e055117b0263430.html">Template Function slint::invoke_from_event_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/function_namespaceslint_1a14298dd1f4c7ab8c553e047e3704d6d0.html">Function slint::quit_event_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/function_namespaceslint_1aa9c106cd8c8b682c8624dcf47c31ae16.html">Function slint::run_event_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/define_slint__generated__public_8h_1aeb2b5fc045f08ccf894bd47b2696b853.html">Define SLINT_VERSION_MAJOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/define_slint__generated__public_8h_1aba0d27c0c821a27a3726baa609646ea9.html">Define SLINT_VERSION_MINOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/define_slint__generated__public_8h_1a498ec177f96b7bce248660a6dd795d8d.html">Define SLINT_VERSION_PATCH</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index (C++)</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging_techniques.html">Debugging Techniques</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="slint-tests">
<h1>Slint tests<a class="headerlink" href="#slint-tests" title="Permalink to this headline">#</a></h1>
<p>This documents describe the testing infrastructure of Slint</p>
<section id="syntax-tests">
<h2>Syntax tests<a class="headerlink" href="#syntax-tests" title="Permalink to this headline">#</a></h2>
<p>The syntax tests are testing that the compiler show the right error messages in case of error.</p>
<p>The syntax tests are located in <code class="docutils literal notranslate"><span class="pre">slint_compiler/tests/syntax/</span></code> and it’s driven by the
<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">syntax_tests.rs</span></code></span> file. More info in the comments of that file.</p>
<p>In summary, each .slint files have comments with <code class="docutils literal notranslate"><span class="pre">^error</span></code> like so:</p>
<div class="highlight-ingore notranslate"><div class="highlight"><pre><span></span>foo bar
//  ^error{parse error}
</pre></div>
</div>
<p>Meaning that there must be an error on the line above at the location pointed by the caret.</p>
<p>Ideally, each error message must be tested like so.</p>
<p>The syntax test can be run alone with</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>cargo<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--test<span class="w"> </span>syntax_tests
</pre></div>
</div>
</section>
<section id="driver-tests">
<h2>Driver tests<a class="headerlink" href="#driver-tests" title="Permalink to this headline">#</a></h2>
<p>These tests make sure that feature in .slint behave as expected.
All the .slint files in the sub directories are going to be test by the drivers with the different
language frontends.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.slint</span></code> code contains a comment with some block of code which is extracted by the relevant driver.</p>
<section id="interpreter-test">
<h3>Interpreter test<a class="headerlink" href="#interpreter-test" title="Permalink to this headline">#</a></h3>
<p>The interpreter test is the faster test to compile and run. It test the compiler and the eval feature
as run by the viewer or such. It can be run like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cargo</span> <span class="n">test</span> <span class="o">-</span><span class="n">p</span> <span class="n">test</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">interpreter</span> <span class="o">--</span>
</pre></div>
</div>
<p>You can add an argument to test only for particular tests.</p>
<p>If there is a property <code class="docutils literal notranslate"><span class="pre">test</span></code> in the last component of the file, the test will make sure this
property equal to bool.</p>
<p>example:</p>
<div class="highlight-slint notranslate"><div class="highlight"><pre><span></span>export component Foo inherits Rectangle {
   // test would fail if that property was false
   in-out property &lt;bool&gt; test: 1 + 1 == 2;
}
</pre></div>
</div>
</section>
<section id="rust-driver">
<h3>Rust driver<a class="headerlink" href="#rust-driver" title="Permalink to this headline">#</a></h3>
<p>The rust driver will compile each snippet of code and put it in a <code class="docutils literal notranslate"><span class="pre">slint!</span></code> macro in its own module
In addition, if there are <code class="docutils literal notranslate"><span class="pre">```rust</span></code> blocks in a comment, they are extracted into a <code class="docutils literal notranslate"><span class="pre">#[test]</span></code>
function in the same module. This is usefull to test the rust api.
This is all compiled in a while program, so the <code class="docutils literal notranslate"><span class="pre">SLINT_TEST_FILTER</span></code> environment variable can be
set while building to only build the test that matches the filter.
Example: to test all the layout test:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SLINT_TEST_FILTER</span><span class="o">=</span><span class="n">layout</span> <span class="n">cargo</span> <span class="n">test</span> <span class="o">-</span><span class="n">p</span> <span class="n">test</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">rust</span>
</pre></div>
</div>
<p>Instead of putting everything in a slint! macro, it’s possible to tell the driver to do the
compilation in the build.rs, with the builod-time feature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SLINT_TEST_FILTER</span><span class="o">=</span><span class="n">layout</span> <span class="n">cargo</span> <span class="n">test</span> <span class="o">-</span><span class="n">p</span> <span class="n">test</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">rust</span> <span class="o">--</span><span class="n">features</span> <span class="n">build</span><span class="o">-</span><span class="n">time</span>
</pre></div>
</div>
</section>
<section id="c-driver">
<h3>C++ driver<a class="headerlink" href="#c-driver" title="Permalink to this headline">#</a></h3>
<p>The C++ test driver will take each .slint and generate a .h for it. It will also generate a .cpp that
includes it, and add the <code class="docutils literal notranslate"><span class="pre">```cpp</span></code> block in the main function.
Each program is compiled separately. And then run.</p>
<p>Some macro like <code class="docutils literal notranslate"><span class="pre">assert_eq</span></code> are defined to look similar to the rust equivalent.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cargo</span> <span class="n">test</span> <span class="o">-</span><span class="n">p</span>  <span class="n">test</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">cpp</span> <span class="o">--</span>
</pre></div>
</div>
<p>Note that there are also C++ unit tests that can be run by CMake</p>
</section>
<section id="node-driver">
<h3>Node driver<a class="headerlink" href="#node-driver" title="Permalink to this headline">#</a></h3>
<p>This is used to test the NodeJS API. It takes the <code class="docutils literal notranslate"><span class="pre">```js</span></code> blocks in comment and make .js file
with it that loads the .slint and runs node with it.
Each test is run in a different node process.
You need to build the node integration before running the tests, even if the change was on the compiler</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cargo</span>  <span class="n">build</span> <span class="o">-</span><span class="n">p</span> <span class="n">slint</span><span class="o">-</span><span class="n">node</span>  <span class="o">&amp;&amp;</span> <span class="n">cargo</span>  <span class="n">test</span> <span class="o">-</span><span class="n">p</span> <span class="n">test</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">nodejs</span>
</pre></div>
</div>
</section>
</section>
<section id="screenshot-tests">
<h2>Screenshot tests<a class="headerlink" href="#screenshot-tests" title="Permalink to this headline">#</a></h2>
<p>This is used to test renderer backends. At the moment it supports the <code class="docutils literal notranslate"><span class="pre">SoftwareRenderer</span></code>. Each <code class="docutils literal notranslate"><span class="pre">.slint</span></code> file in <code class="docutils literal notranslate"><span class="pre">tests/screenshots/cases</span></code> will be loaded
rendered and the results will be compared to the reference images in <code class="docutils literal notranslate"><span class="pre">tests/screenshots/references</span></code>.</p>
<p>To generate references images for all test files in <code class="docutils literal notranslate"><span class="pre">tests/screenshots/cases</span></code> run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SLINT_CREATE_SCREENSHOTS</span><span class="o">=</span><span class="mi">1</span> <span class="n">cargo</span> <span class="n">test</span> <span class="o">-</span><span class="n">p</span> <span class="n">test</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">screenshots</span>
</pre></div>
</div>
<p>To start the tests run and compare images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cargo</span> <span class="n">test</span> <span class="o">-</span><span class="n">p</span> <span class="n">test</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">screenshots</span>
</pre></div>
</div>
</section>
<section id="doctests">
<h2>Doctests<a class="headerlink" href="#doctests" title="Permalink to this headline">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cargo</span> <span class="n">test</span> <span class="o">-</span><span class="n">p</span> <span class="n">doctests</span>
</pre></div>
</div>
<p>The doctests extracts the <code class="docutils literal notranslate"><span class="pre">```slint</span></code>  from the files in the docs folder and make  sure that
the snippets can be build without errors</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; SixtyFPS GmbH
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Slint tests</a><ul>
<li><a class="reference internal" href="#syntax-tests">Syntax tests</a></li>
<li><a class="reference internal" href="#driver-tests">Driver tests</a><ul>
<li><a class="reference internal" href="#interpreter-test">Interpreter test</a></li>
<li><a class="reference internal" href="#rust-driver">Rust driver</a></li>
<li><a class="reference internal" href="#c-driver">C++ driver</a></li>
<li><a class="reference internal" href="#node-driver">Node driver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#screenshot-tests">Screenshot tests</a></li>
<li><a class="reference internal" href="#doctests">Doctests</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
    <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    
<!--
    This file is used to add preview of the `.slint` snippets in the generated rustdoc documentation.
    It can be injected via the `--html-in-header slint-docs-preview.html` option of rustdoc.
-->
<script type="module">
    "use strict";
    import * as slint from 'https://slint.dev/releases/1.1.0/wasm-interpreter/slint_wasm_interpreter.js';
    const editor_url = "https://slint.dev/releases/1.1.0/editor/";
    // keep them alive
    var all_instances = new Array;

    async function render_or_error(source, div) {
        let canvas_id = 'canvas_' + Math.random().toString(36).substr(2, 9);
        let canvas = document.createElement("canvas");
        canvas.id = canvas_id;
        div.appendChild(canvas);

        let { component, error_string } = await slint.compile_from_string(source, "");
        if (error_string != "") {
            var text = document.createTextNode(error_string);
            var p = document.createElement('pre');
            p.appendChild(text);
            div.innerHTML = "<pre style='color: red; background-color:#fee; margin:0'>" + p.innerHTML + "</pre>";
        }
        if (component !== undefined) {
            let instance = await component.create(canvas_id);
            await instance.show();
            all_instances.push(instance);
        }
    }

    async function create_preview(element, source_code) {
        let div = document.createElement("div");
        div.style = "float: right; padding:0; margin:0;";
        element.prepend(div);
        await render_or_error(source_code, div);
    }

    function should_show_automatic_preview(element) {
        // Safari blocks quite heavily when creating many WebGL contexts, slowing down loading of the docs
        // significantly. For now, don't do automatic previews:
        if (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1) {
            return false;
        }
        // The `no-auto-preview` doesn't map directly to a dedicated class but it's mangled differently
        // between rustdoc and sphinx, so match fuzzy on the entire class list:
        return !element.className.includes("no-auto-preview");
    }

    async function create_click_to_play_and_edit_buttons(element) {
        let source = element.innerText;

        let link_section = document.createElement("div");
        element.append(link_section);

        let button_style = "text-decoration: none;"

        let edit_button = document.createElement("a");
        edit_button.style = button_style;
        edit_button.href = `${editor_url}?snippet=${encodeURIComponent(source)}`;
        edit_button.target = "_blank";
        edit_button.innerText = "Edit 📝";
        link_section.append(edit_button);

        if (should_show_automatic_preview(element)) {
            create_preview(element, source);
        } else {
            let play_button = document.createElement("a");
            play_button.style = button_style;
            play_button.innerText = "Preview ▶️";
            play_button.onclick = async () => {
                play_button.remove();
                create_preview(element, source);
            };

            link_section.prepend(play_button);
        }
    }

    async function run() {
        await slint.default();

        try {
            slint.run_event_loop();
            // this will trigger a JS exception, so this line will never be reached!
        } catch (e) {
            // The winit event loop, when targeting wasm, throws a JavaScript exception to break out of
            // Rust without running any destructors. Don't rethrow the exception but swallow it, as
            // this is no error and we truly want to resolve the promise of this function by returning
            // the model markers.
        }

        let selector = ["code.language-slint", ".rustdoc pre.language-slint", "div.highlight-slint div.highlight", "div.highlight-slint\\,no-auto-preview div.highlight"]
            .map((sel) => `${sel}:not([class*=slint\\,ignore]):not([class*=slint\\,no-preview])`).join(",");
        var elements = document.querySelectorAll(selector);
        for (var i = 0; i < elements.length; ++i) {
            await create_click_to_play_and_edit_buttons(elements[i]);
        }
    }
    run();

    // Included markdown files may have links to other markdown files, which may not have been
    // resolved by rustdoc. This helper locates such links and resolves them, assuming that each
    // .md file gets its own sub-directory with an index.html.
    function fix_markdown_links() {
        for (let anchor of document.querySelectorAll('a[href$=".md"], a[href*=".md#"]')) {
            let url = new URL(anchor.href);
            let dir_separator = Math.max(url.pathname.lastIndexOf("/"), 0);
            let base_name = url.pathname.slice(dir_separator + 1, -3);
            let base_path = url.pathname.slice(0, dir_separator);
            url.pathname = base_path + "/../" + base_name + "/index.html";
            anchor.setAttribute("href", url);
        }
    }
    fix_markdown_links()
</script>
<!--
    This file is used to add syntax highlighting of the `.slint` snippets in the generated rustdoc, sphinx and mdbook documentation.
    It can be injected via the `--html-in-header slint-docs-highlight.html` option of rustdoc, is included via _templates/layout.html
    in sphinx and via head.hbs in mdbook.
-->
<link rel="stylesheet" href="https://slint.dev/resources/highlightjs/11.0.1/default.min.css">
<script src="https://slint.dev/resources/highlightjs/11.0.1/highlight.min.js"></script>
<script>
  function highlight_slint(hljs) {
    const KEYWORDS = {
      keyword:
        "animate callback component export for function global if import in in-out inherits out parent private property public pure root self signal states struct transitions",
      literal: "false true",
      built_in:
        "ArcTo Clip Close Colors CubicTo Flickable FocusScope GridLayout HorizontalLayout Image LineTo Math MoveTo Path PopupWindow QuadraticTo Rectangle Row Text TextInput TouchArea VerticalLayout Window animation-tick debug",
      type: "bool duration easing float int length logical_length relative-font-size resource string",
    };

    return {
      name: 'slint',
      case_insensitive: false,
      keywords: KEYWORDS,
      contains: [
        hljs.QUOTE_STRING_MODE,
        hljs.C_LINE_COMMENT_MODE,
        hljs.C_BLOCK_COMMENT_MODE,
        hljs.COMMENT('/\\*', '\\*/', {
          contains: ['self']
        }),
        {
          className: 'number',
          begin: '\\b\\d+(\\.\\d+)?(\\w+)?',
          relevance: 0
        },
        {
          className: 'title',
          begin: '\\b[_a-zA-Z][_\\-a-zA-Z0-9]* *:=',
        },
        {
          className: 'symbol',
          begin: '\\b[_a-zA-Z][_\\-a-zA-Z0-9]*(:| *=>)',
        },
        {
          className: 'built_in',
          begin: '\\b[_a-zA-Z][_\\-a-zA-Z0-9]*!',
        },
      ],
      illegal: /@/
    };
  };

  // Tags used in fenced code blocks
  for (let tag of ["slint", "slint,no-preview", "slint,no-auto-preview", "slint,ignore"]) {
    hljs.registerLanguage(tag, highlight_slint);
  }


  window.addEventListener("DOMContentLoaded", () => {
    const rustDoc = document.querySelector('meta[name="generator"]')?.content == "rustdoc";
    if (rustDoc) {
      // Only highlight .slint blocks, leave the others to rustdoc
      for (slintBlock of document.querySelectorAll("[class*=language-slint]")) {
        hljs.highlightElement(slintBlock)
      }

      // Some of the rustdoc selectors require the pre element to have the rust class
      for (codeBlock of document.querySelectorAll(".language-slint.hljs")) {
        codeBlock.parentElement.classList.add("rust")
      }

      // Change the hljs generated classes to the rustdoc
      // ones, so that the highlighting adjusts to the theme correctly.
      const highlightJSToRustDoc = [
        ["comment", "comment"],
        ["number", "number"],
        ["symbol", "struct"], // width:
        ["keyword", "kw"],
        ["built_in", "primitive"],
        ["string", "string"],
        ["title", "fnname"], // Foo :=
        ["type", "type"]
      ];

      for ([hljs_class, rustdoc_class] of highlightJSToRustDoc) {
        for (titleElement of document.querySelectorAll(`.hljs-${hljs_class}`)) {
          titleElement.classList.remove(`hljs-${hljs_class}`);
          titleElement.classList.add(rustdoc_class);
        }
      }
    } else {
      // For use with the mdbook Tutorial
      hljs.highlightAll();

      // The Sphinx/my_st generated HTML for code blocks doesn't use <code> tags, so highlight.js'
      // default selector "pre code" doesn't match. Let's do it by hand:
      for (block of document.querySelectorAll("div[class*=highlight-slint] div.highlight pre")) {
        hljs.highlightElement(block)
      }
    }
  });
</script>
</body>
</html>